<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="./node_modules/axios/dist/axios.min.js"></script>
        <style>
            th, td, p, input, h3 {
                font:15px 'Segoe UI';
            }
            table, th, td {
                border: solid 1px #ddd;
                border-collapse: collapse;
                padding: 2px 3px;
                text-align: center;
            }
            th {
                font-weight:bold;
            }
        </style>
        <script type="text/javascript" src="./js/script.js"></script>
    </head>
    <body onload="tableFromJson()">
        <button type="button" onclick="transfer('a@gmail.com', 'c@gmail.com'), transferDetails()">transfer</button>
        <label for="fromCustomer">From: </label>
            <select name="fromCustomer" id="fromCustomer" onchange="setCustomerValue()">
                <option value="a@gmail.com">A</option>
                <option value="b@gmail.com">B</option>
                <option value="c@gmail.com">C</option>
                <option value="d@gmail.com">D</option>
                <option value="e@gmail.com">E</option>
                <option value="f@gmail.com">F</option>
                <option value="g@gmail.com">G</option>
                <option value="h@gmail.com">H</option>
                <option value="i@gmail.com">I</option>
                <option value="j@gmail.com">J</option>
            </select>
        <label for="toCustomer">To: </label>
            <select name="toCustomer" id="toCustomer" onchange="setCustomerValue()">
                <option value="a@gmail.com">A</option>
                <option value="b@gmail.com">B</option>
                <option value="c@gmail.com">C</option>
                <option value="d@gmail.com">D</option>
                <option value="e@gmail.com">E</option>
                <option value="f@gmail.com">F</option>
                <option value="g@gmail.com">G</option>
                <option value="h@gmail.com">H</option>
                <option value="i@gmail.com">I</option>
                <option value="j@gmail.com">J</option>
            </select>
        <label for="amountTransfered">Amount to be transfered</label>
            <input type="number" id="amountTransfered" value="0" onchange="setCustomerValue(this.value)">
        <br>
        <p id='showData'></p>
        <input type="text" name="fname" value="A" onchange="myFunction(this.value)">
        <script>
            // document.getElementById("myform").addEventListener("submit", function(e) {
            //     e.preventDefault()
            // })
            // function myFunction(val) {
            //     console.log(val)
            // }
            var x="a@gmail.com", y="a@gmail.com", amountTransfered = 0;
            function setCustomerValue(val) {
                this.x = document.getElementById("fromCustomer").value;
                console.log(x);
                this.y = document.getElementById("toCustomer").value;
                console.log(y)
                console.log(val)
                this.amountTransfered = val;
                console.log(amountTransfered);
            }
            function transferDetails() {
                console.log("from transfer", this.x);
                console.log("to transfer:", this.y)
                transfer(this.x,this.y, this.amountTransfered);
            }
        </script>
    </body>
    <script>
        async function tableFromJson() {
            let myCustomers = await getCustomerDetails();
            myCustomers = myCustomers.map((item) => {
                delete item._id
                delete item.__v
                return item
            })
    console.log(myCustomers)
            var col = [];

            for(var i = 0; i < myCustomers.length; i++) {
                for(var key in myCustomers[i]) {
                    if(col.indexOf(key) === -1) {
                        col.push(key)
                    }
                }
            }

            var table = document.createElement("table");
            var tr = table.insertRow(-1);

            for (var i = 0; i < col.length; i++) {
                var th = document.createElement("th");      // table header.
                th.innerHTML = col[i];
                tr.appendChild(th);
            }

            for (var i = 0; i < myCustomers.length; i++) {

                tr = table.insertRow(-1);

                for (var j = 0; j < col.length; j++) {
                    var tabCell = tr.insertCell(-1);
                    tabCell.innerHTML = myCustomers[i][col[j]];
                }
                }

                // Now, add the newly created table with json data, to a container.
                var divShowData = document.getElementById('showData');
                divShowData.innerHTML = "";
                divShowData.appendChild(table);
            }
    </script>
</html>


<!-- // document.getElementById('msg').innerHTML = '<br />You can later <a href="https://www.encodedna.com/javascript/dynamically-add-remove-rows-to-html-table-using-javascript-and-save-data.htm" target="_blank" style="color:#1464f4;text-decoration:none;">get all the data from table and save it in a database.</a>'; -->